<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<title>Google Maps Multiple Markers</title>
		<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<link rel="stylesheet" href="css/style.css" type="text/css" />
	</head>
	<body>
		<div id="map" class="gmap3"></div>
		<script type="text/javascript">
			var image = {
				url : 'http://maps.google.com/mapfiles/marker_green.png',
				// This marker is 20 pixels wide by 32 pixels tall.
				size : new google.maps.Size(20, 32),
				// The origin for this image is 0,0.
				origin : new google.maps.Point(0, 0),
				// The anchor for this image is the base of the flagpole at 0,32.
				anchor : new google.maps.Point(0, 32)
			};
		//	var shadow = {
		//		url : 'https://developers.google.com/maps/documentation/javascript/examples/images/beachflag_shadow.png',
				// The shadow image is larger in the horizontal dimension
				// while the position and offset are the same as for the main image.
		//		size : new google.maps.Size(37, 32),
		//		origin : new google.maps.Point(0, 0),
		//		anchor : new google.maps.Point(0, 32)
		//	};

			var map = new google.maps.Map(document.getElementById('map'), {
				zoom : 2,
				center : new google.maps.LatLng(21.809229444410303, 66.42642420687956),
				mapTypeId : google.maps.MapTypeId.ROADMAP
			});

			var infowindow = new google.maps.InfoWindow();
			setInterval(function() {
			setTimeout(function() {
				loadData();
			}, 500);	}, 1000);
			function loadData() {
				//alert("Loading");
				var marker, i;

				var url = "http://open-notify-api.herokuapp.com/iss-now.json?callback=?";
				var name;
				var lat;
				var lon;
				var locations;
				
				
					$.getJSON(url, function(response) {handleData(response)
					});
			
				
			}

var marker
			function handleData(response) {
				//alert(response);
				var n;
				// for(n=0; n<response.items.length; n++)
				//{
				name = response.timestamp;
				//alert(name);
				lat = response.iss_position.latitude;
				lon = response.iss_position.longitude;
				var myLatLng = new google.maps.LatLng(lat, lon);
				if (marker) {
        		marker.setPosition(myLatLng);
        	    }else{
				marker = new google.maps.Marker({
					position : myLatLng,
				//	shadow : shadow,
					icon : image,
					map : map,
					title : name,
					zIndex : 1
				});
				}
			}
		</script>
	</body>
</html>
